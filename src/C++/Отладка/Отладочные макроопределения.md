## Отладочные макроопределения

Разработчики стандартной библиотеки уже подумали о нас и добавили проверки для обнаружения самых разных ошибок. Эти проверки отключены по умолчанию. Чтобы их включить, нужно определить ряд макросов, зависящих от того, какую стандартную библиотеку вы используете.

- **libstdc++**. Эта библиотека обычно присутствует на Linux и Windows для gcc, clang. Для отладки нужно определить макросы _GLIBCXX_DEBUG и _GLIBCXX_DEBUG_PEDANTIC.

- **libc++**. По умолчанию на MacOS. Для включения проверок нужно определить _LIBCPP_DEBUG=1.

- **Microsoft/STL**. Используется в Visual Studio. Проверки включаются макросом _DEBUG, который автоматически добавляется компилятором при выборе отладочной библиотеки времени выполнения.

> Как я попробовал, в MacOS + clang - выдается что-то нечитабельное. Поэтому пока остановился на g++11. А там потом посмотрим, тем более курс идет на этом компиляторе.

Мой CMakeList.txt

```bash
set(CMAKE_C_COMPILER /usr/local/bin/gcc-11)
set(CMAKE_CXX_COMPILER /usr/local/bin/g++-11)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# Для нормального отображение содержимого STL контейнеров в дебагере
# https://www.jetbrains.com/help/clion/configuring-debugger-options.html#gdb-config
set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -gdwarf-3 -D_LIBCPP_DEBUG=1 -D_GLIBCXX_DEBUG -D_GLIBCXX_DEBUG_PEDANTIC")
set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} -gdwarf-3")
```

### Использование дебагера

Программа падает, сообщая подробности: индекс элемента и размер массива. Под Linux также может быть выведен полный стек вызовов. Чтобы найти точное место ошибки можно опять же воспользоваться gdb с командой break abort.

> В CLion можно просто запустить программу в режиме отладки, без точек останова. Дебагер остановится на первом исключении. 

